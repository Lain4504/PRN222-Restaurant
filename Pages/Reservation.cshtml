@page "/reservation"
@model PRN222_Restaurant.Pages.ReservationModel
@{
    ViewData["Title"] = "Make a Reservation";
}

<!-- Reservation Hero Section -->
<section class="relative py-16 md:py-24">
    <!-- Background Image with Overlay -->
    <div class="absolute inset-0 z-0">
        <img src="https://images.unsplash.com/photo-1550966871-3ed3cdb5ed0c?q=80&w=2070" 
             alt="Restaurant Interior" 
             class="w-full h-full object-cover" />
        <div class="absolute inset-0 bg-gradient-to-b from-slate-900/80 to-slate-900/80"></div>
    </div>
    
    <div class="container mx-auto px-4 relative z-10">
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">Reserve Your Table</h1>
            <p class="text-xl text-slate-200 max-w-2xl mx-auto">
                Secure your spot for an unforgettable dining experience with the freshest seafood
            </p>
        </div>
    </div>
</section>

<!-- Reservation Form Section -->
<section class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body p-8">
                    <h2 class="card-title text-2xl mb-6">Reservation Details</h2>
                    
                    <form id="reservationForm" class="space-y-6">
                        <div asp-validation-summary="ModelOnly" class="text-red-500"></div>
                        
                        <!-- Date and Time Selection -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="form-control">
                                <label asp-for="ReservationDate" class="label">
                                    <span class="label-text">Date</span>
                                </label>
                                <input asp-for="ReservationDate" type="date" 
                                       class="input input-bordered w-full" 
                                       min="@DateTime.Now.ToString("yyyy-MM-dd")" />
                                <span asp-validation-for="ReservationDate" class="text-red-500"></span>
                            </div>
                            
                            <div class="form-control">
                                <label asp-for="ReservationTime" class="label">
                                    <span class="label-text">Time</span>
                                </label>
                                <input asp-for="ReservationTime" type="time" 
                                       class="input input-bordered w-full" />
                                <span asp-validation-for="ReservationTime" class="text-red-500"></span>
                            </div>
                        </div>
                        
                        <!-- Number of Guests -->
                        <div class="form-control">
                            <label asp-for="NumberOfGuests" class="label">
                                <span class="label-text">Number of Guests</span>
                            </label>
                            <input asp-for="NumberOfGuests" type="number" min="1" max="20" 
                                   class="input input-bordered w-full" />
                            <span asp-validation-for="NumberOfGuests" class="text-red-500"></span>
                        </div>
                        
                        <!-- Table Selection -->
                        <div class="form-control">
                            <label asp-for="TableId" class="label">
                                <span class="label-text">Select Table</span>
                            </label>
                            <select asp-for="TableId" asp-items="Model.AvailableTables" 
                                    class="select select-bordered w-full">
                                <option value="">-- Select a table --</option>
                            </select>
                            <span asp-validation-for="TableId" class="text-red-500"></span>
                        </div>
                        
                        <!-- Additional Notes -->
                        <div class="form-control">
                            <label asp-for="Note" class="label">
                                <span class="label-text">Additional Notes (Optional)</span>
                            </label>
                            <textarea asp-for="Note" class="textarea textarea-bordered h-24" 
                                      placeholder="Any special requests or requirements?"></textarea>
                            <span asp-validation-for="Note" class="text-red-500"></span>
                        </div>
                        
                        <!-- Submit Button -->
                        <div class="form-control mt-6">
                            <button type="submit" class="btn btn-primary">Continue to Menu Selection</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Reservation Policy -->
            <div class="mt-12 p-6 bg-slate-50 rounded-xl">
                <h3 class="text-xl font-bold text-slate-800 mb-4">Reservation Policy</h3>
                <ul class="list-disc pl-5 space-y-2 text-slate-700">
                    <li>Reservations are held for 15 minutes past the scheduled time.</li>
                    <li>For parties of 8 or more, please call us directly at (212) 555-1234.</li>
                    <li>A credit card is required for reservations on Friday and Saturday evenings.</li>
                    <li>Cancellations must be made at least 24 hours in advance.</li>
                    <li>For special events or private dining, please contact our events team.</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<!-- Confirmation Modal -->
<dialog id="confirmationModal" class="modal">
    <div class="modal-box">
        <h3 class="font-bold text-lg text-primary">Confirm Your Reservation</h3>
        <div class="py-4">
            <p class="mb-4">Please review your reservation details:</p>
            
            <div class="space-y-2 mb-6">
                <p><span class="font-medium">Name:</span> <span id="confirmName"></span></p>
                <p><span class="font-medium">Email:</span> <span id="confirmEmail"></span></p>
                <p><span class="font-medium">Phone:</span> <span id="confirmPhone"></span></p>
                <p><span class="font-medium">Guests:</span> <span id="confirmGuests"></span></p>
                <p><span class="font-medium">Date:</span> <span id="confirmDate"></span></p>
                <p><span class="font-medium">Time:</span> <span id="confirmTime"></span></p>
                <p><span class="font-medium">Special Requests:</span> <span id="confirmRequests" class="italic">None</span></p>
            </div>
            
            <p>Is everything correct?</p>
        </div>
        <div class="modal-action">
            <button class="btn btn-outline" onclick="closeConfirmationModal()">Edit</button>
            <button id="submitReservation" class="btn btn-primary">Confirm Reservation</button>
        </div>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

<!-- Success Modal -->
<dialog id="successModal" class="modal">
    <div class="modal-box">
        <div class="flex flex-col items-center justify-center py-4">
            <div class="text-center mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-success mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
            <h3 class="font-bold text-xl mb-2">Reservation Confirmed!</h3>
            <p class="text-center mb-6">
                Thank you for choosing Ocean Delights. Your reservation has been successfully booked. A confirmation email has been sent to your email address.
            </p>
            <div class="flex gap-4">
                <a href="/" class="btn btn-outline">Return to Homepage</a>
                <a href="/menu" class="btn btn-primary">View Our Menu</a>
            </div>
        </div>
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dateInput = document.querySelector('input[type="date"]');
            const timeInput = document.querySelector('input[type="time"]');
            
            // Set minimum date to today
            const today = new Date().toISOString().split('T')[0];
            dateInput.min = today;
            
            // Set default time to next available hour
            const now = new Date();
            const nextHour = new Date(now.getTime() + 60 * 60 * 1000);
            timeInput.value = nextHour.toTimeString().slice(0, 5);
            
            // Form validation
            document.getElementById('reservationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                openConfirmationModal();
            });
            
            // Submit reservation
            document.getElementById('submitReservation').addEventListener('click', function() {
                // Would normally submit to server here
                
                // Close confirmation modal
                closeConfirmationModal();
                
                // Show success modal
                document.getElementById('successModal').showModal();
                
                // Reset form
                document.getElementById('reservationForm').reset();
            });
        });
        
        function openConfirmationModal() {
            // Get form values
            const name = document.getElementById('fullName').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const guests = document.getElementById('guests').value;
            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;
            const requests = document.getElementById('specialRequests').value;
            
            // Validate form
            if (!name || !email || !phone || !guests || !date || !time) {
                alert('Please fill in all required fields');
                return;
            }
            
            // Format date
            const formattedDate = new Date(date).toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Populate confirmation modal
            document.getElementById('confirmName').textContent = name;
            document.getElementById('confirmEmail').textContent = email;
            document.getElementById('confirmPhone').textContent = phone;
            document.getElementById('confirmGuests').textContent = guests === '1' ? '1 Person' : `${guests} People`;
            document.getElementById('confirmDate').textContent = formattedDate;
            document.getElementById('confirmTime').textContent = time;
            document.getElementById('confirmRequests').textContent = requests || 'None';
            
            // Show confirmation modal
            document.getElementById('confirmationModal').showModal();
        }
        
        function closeConfirmationModal() {
            document.getElementById('confirmationModal').close();
        }
    </script>
}
